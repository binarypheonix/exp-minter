{"ast":null,"code":"import _toConsumableArray from \"/Users/frankenstein/projects/minter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/Users/frankenstein/projects/minter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\n\n// Taken from https://github.com/WalletConnect/walletconnect-monorepo/blob/master/packages/qrcode-modal/src/browser.ts\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { getColorMode } from '../../colorMode';\nimport { generateGUID } from '../../utils/generate-uuid';\nimport { getTzip10Link } from '../../utils/get-tzip10-link';\nimport { getQrData } from '../../utils/qr';\nimport { replaceInTemplate } from '../../utils/replace-in-template';\nimport { alertTemplates } from './alert-templates';\nimport { preparePairingAlert } from './PairingAlert';\nvar lastFocusedElement;\nvar document;\n\nif (typeof window !== 'undefined' && typeof window.document !== 'undefined') {\n  document = window.document;\n}\n\nvar timeout = {};\n\nvar formatQR = function formatQR(dataString, pairingPayload) {\n  if (typeof dataString === 'string') {\n    var uri = getTzip10Link('tezos://', pairingPayload);\n    var qr = getQrData(uri, 'svg');\n    var qrString = qr.replace('<svg', \"<svg class=\\\"beacon-alert__image\\\"\");\n    return \"<div id=\\\"beacon--qr__container\\\">\".concat(qrString, \"<div id=\\\"beacon--qr__copy__container\\\"><button class=\\\"beacon-modal__button--outline\\\" id=\\\"beacon--qr__copy\\\">Copy</button></div></div>\").concat(dataString);\n  }\n\n  return dataString;\n};\n\nvar formatAlert = function formatAlert(id, body, title, buttons, pairingPayload) {\n  var callToAction = title;\n  var buttonsHtml = buttons.map(function (button, index) {\n    return \"<button id=\\\"beacon-alert-\".concat(id, \"-\").concat(index, \"\\\" class=\\\"beacon-modal__button\").concat(button.style === 'outline' ? '--outline' : '', \"\\\">\").concat(button.text, \"</button>\");\n  });\n  var allStyles = alertTemplates.default.css;\n\n  if (pairingPayload) {\n    allStyles += alertTemplates.pair.css;\n  }\n\n  var alertContainer = alertTemplates.container;\n  alertContainer = replaceInTemplate(alertContainer, 'main', pairingPayload ? alertTemplates.pair.html : alertTemplates.default.html);\n  alertContainer = replaceInTemplate(alertContainer, 'callToAction', callToAction);\n  alertContainer = replaceInTemplate(alertContainer, 'buttons', buttonsHtml.join(' '));\n  alertContainer = replaceInTemplate(alertContainer, 'body', body);\n  alertContainer = replaceInTemplate(alertContainer, 'id', id);\n  alertContainer = replaceInTemplate(alertContainer, 'payload', pairingPayload !== null && pairingPayload !== void 0 ? pairingPayload : '');\n\n  if (alertContainer.indexOf('{{') >= 0) {\n    var start = alertContainer.indexOf('{{');\n    var end = alertContainer.indexOf('}}');\n    console.error('Not all placeholders replaced!', alertContainer.substr(start, end - start));\n    throw new Error('Not all placeholders replaced!');\n  }\n\n  return {\n    style: allStyles,\n    html: alertContainer\n  };\n};\n/**\n * Close an alert by ID\n *\n * @param id ID of alert\n */\n\n\nvar closeAlert = function closeAlert(id) {\n  return new Promise(function (resolve) {\n    var _a;\n\n    var wrapper = document.getElementById(\"beacon-alert-wrapper-\".concat(id));\n\n    if (!wrapper) {\n      return resolve();\n    }\n\n    var elm = (_a = wrapper.shadowRoot) === null || _a === void 0 ? void 0 : _a.getElementById(\"beacon-alert-modal-\".concat(id));\n\n    if (elm) {\n      var animationDuration = 300;\n      var localTimeout = timeout[id];\n\n      if (localTimeout) {\n        clearTimeout(localTimeout);\n        timeout[id] = undefined;\n      }\n\n      elm.className = elm.className.replace('fadeIn', 'fadeOut');\n      window.setTimeout(function () {\n        var parent = wrapper.parentNode;\n\n        if (parent) {\n          parent.removeChild(wrapper);\n        }\n\n        if (lastFocusedElement) {\n          ;\n          lastFocusedElement.focus(); // set focus back to last focussed element\n        }\n\n        resolve();\n      }, animationDuration);\n    } else {\n      resolve();\n    }\n  });\n};\n/**\n * Close all alerts\n */\n\n\nvar closeAlerts = function closeAlerts() {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            return _context3.abrupt(\"return\", new Promise(function (resolve) {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                var openAlertElements, alertIds;\n                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        openAlertElements = document.querySelectorAll('[id^=\"beacon-alert-wrapper-\"]');\n\n                        if (!(openAlertElements.length > 0)) {\n                          _context2.next = 9;\n                          break;\n                        }\n\n                        alertIds = [];\n                        openAlertElements.forEach(function (element) {\n                          return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                            return _regeneratorRuntime.wrap(function _callee$(_context) {\n                              while (1) {\n                                switch (_context.prev = _context.next) {\n                                  case 0:\n                                    alertIds.push(element.id.split('-')[3]);\n\n                                  case 1:\n                                  case \"end\":\n                                    return _context.stop();\n                                }\n                              }\n                            }, _callee);\n                          }));\n                        });\n                        _context2.next = 6;\n                        return Promise.all(alertIds.map(closeAlert));\n\n                      case 6:\n                        resolve();\n                        _context2.next = 10;\n                        break;\n\n                      case 9:\n                        resolve();\n\n                      case 10:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, _callee2);\n              }));\n            }));\n\n          case 1:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n};\n/**\n * Show an alert\n *\n * @param alertConfig The configuration of the alert\n */\n// eslint-disable-next-line complexity\n\n\nvar openAlert = function openAlert(alertConfig) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n    var _a, _b, body, title, timer, pairingPayload, closeButtonCallback, id, shadowRootEl, shadowRoot, wrapper, buttons, formattedBody, _formatAlert, style, html, styleEl, closeButton, closeButtonClick, colorMode, elm, modal;\n\n    return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n      while (1) {\n        switch (_context9.prev = _context9.next) {\n          case 0:\n            body = alertConfig.body;\n            title = alertConfig.title;\n            timer = alertConfig.timer;\n            pairingPayload = alertConfig.pairingPayload; // eslint-disable-next-line @typescript-eslint/unbound-method\n\n            closeButtonCallback = alertConfig.closeButtonCallback;\n            _context9.next = 7;\n            return closeAlerts();\n\n          case 7:\n            _context9.next = 9;\n            return generateGUID();\n\n          case 9:\n            id = _context9.sent.split('-').join('');\n            shadowRootEl = document.createElement('div');\n            shadowRootEl.setAttribute('id', \"beacon-alert-wrapper-\".concat(id));\n            shadowRoot = shadowRootEl.attachShadow({\n              mode: 'open'\n            });\n            wrapper = document.createElement('div');\n            wrapper.setAttribute('tabindex', \"0\"); // Make modal focussable\n\n            shadowRoot.appendChild(wrapper);\n            buttons = _toConsumableArray((_b = (_a = alertConfig.buttons) === null || _a === void 0 ? void 0 : _a.map(function (button) {\n              var _a, _b;\n\n              return {\n                text: button.text,\n                // eslint-disable-next-line @typescript-eslint/unbound-method\n                actionCallback: (_a = button.actionCallback) !== null && _a !== void 0 ? _a : function () {\n                  return Promise.resolve();\n                },\n                style: (_b = button.style) !== null && _b !== void 0 ? _b : 'outline'\n              };\n            })) !== null && _b !== void 0 ? _b : []);\n            formattedBody = body && pairingPayload ? formatQR(body, pairingPayload === null || pairingPayload === void 0 ? void 0 : pairingPayload.p2pSyncCode) : body !== null && body !== void 0 ? body : '';\n            _formatAlert = formatAlert(id, formattedBody, title, buttons, pairingPayload === null || pairingPayload === void 0 ? void 0 : pairingPayload.p2pSyncCode), style = _formatAlert.style, html = _formatAlert.html;\n            wrapper.innerHTML = html;\n            styleEl = document.createElement('style');\n            styleEl.textContent = style;\n            shadowRoot.appendChild(styleEl);\n\n            if (timer) {\n              timeout[id] = window.setTimeout(function () {\n                return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n                  return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                    while (1) {\n                      switch (_context4.prev = _context4.next) {\n                        case 0:\n                          _context4.next = 2;\n                          return closeAlert(id);\n\n                        case 2:\n                        case \"end\":\n                          return _context4.stop();\n                      }\n                    }\n                  }, _callee4);\n                }));\n              }, timer);\n            }\n\n            document.body.prepend(shadowRootEl);\n            closeButton = shadowRoot.getElementById(\"beacon-alert-\".concat(id, \"-close\"));\n\n            closeButtonClick = function closeButtonClick() {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n                return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                  while (1) {\n                    switch (_context5.prev = _context5.next) {\n                      case 0:\n                        if (closeButtonCallback) {\n                          closeButtonCallback();\n                        }\n\n                        _context5.next = 3;\n                        return closeAlert(id);\n\n                      case 3:\n                      case \"end\":\n                        return _context5.stop();\n                    }\n                  }\n                }, _callee5);\n              }));\n            };\n\n            colorMode = getColorMode();\n            elm = shadowRoot.getElementById(\"beacon-alert-modal-\".concat(id));\n\n            if (elm) {\n              elm.classList.add(\"theme__\".concat(colorMode));\n              elm.addEventListener('click', closeButtonClick); // Backdrop click dismisses alert\n            }\n\n            modal = shadowRoot.querySelectorAll('.beacon-modal__wrapper');\n\n            if (modal.length > 0) {\n              modal[0].addEventListener('click', function (event) {\n                event.stopPropagation();\n              });\n            }\n\n            lastFocusedElement = document.activeElement; // Store which element has been focussed before the alert is shown\n\n            wrapper.focus(); // Focus alert for accessibility\n\n            buttons.forEach(function (button, index) {\n              var buttonElement = shadowRoot.getElementById(\"beacon-alert-\".concat(id, \"-\").concat(index));\n\n              if (buttonElement) {\n                buttonElement.addEventListener('click', function () {\n                  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n                    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                      while (1) {\n                        switch (_context6.prev = _context6.next) {\n                          case 0:\n                            _context6.next = 2;\n                            return closeAlert(id);\n\n                          case 2:\n                            if (!button.actionCallback) {\n                              _context6.next = 5;\n                              break;\n                            }\n\n                            _context6.next = 5;\n                            return button.actionCallback();\n\n                          case 5:\n                          case \"end\":\n                            return _context6.stop();\n                        }\n                      }\n                    }, _callee6);\n                  }));\n                });\n              }\n            });\n\n            if (closeButton) {\n              closeButton.addEventListener('click', function () {\n                return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n                  return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n                    while (1) {\n                      switch (_context7.prev = _context7.next) {\n                        case 0:\n                          _context7.next = 2;\n                          return closeButtonClick();\n\n                        case 2:\n                        case \"end\":\n                          return _context7.stop();\n                      }\n                    }\n                  }, _callee7);\n                }));\n              });\n            }\n\n            window.addEventListener('keydown', function (event) {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n                return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n                  while (1) {\n                    switch (_context8.prev = _context8.next) {\n                      case 0:\n                        if (!(event.key === 'Escape')) {\n                          _context8.next = 3;\n                          break;\n                        }\n\n                        _context8.next = 3;\n                        return closeButtonClick();\n\n                      case 3:\n                      case \"end\":\n                        return _context8.stop();\n                    }\n                  }\n                }, _callee8);\n              }));\n            });\n\n            if (!pairingPayload) {\n              _context9.next = 40;\n              break;\n            }\n\n            _context9.next = 40;\n            return preparePairingAlert(shadowRoot, pairingPayload);\n\n          case 40:\n            return _context9.abrupt(\"return\", id);\n\n          case 41:\n          case \"end\":\n            return _context9.stop();\n        }\n      }\n    }, _callee9);\n  }));\n};\n\nexport { closeAlert, closeAlerts, openAlert };","map":{"version":3,"sources":["../../../../src/ui/alert/Alert.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["// Taken from https://github.com/WalletConnect/walletconnect-monorepo/blob/master/packages/qrcode-modal/src/browser.ts\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { getColorMode } from '../../colorMode';\nimport { generateGUID } from '../../utils/generate-uuid';\nimport { getTzip10Link } from '../../utils/get-tzip10-link';\nimport { getQrData } from '../../utils/qr';\nimport { replaceInTemplate } from '../../utils/replace-in-template';\nimport { alertTemplates } from './alert-templates';\nimport { preparePairingAlert } from './PairingAlert';\nlet lastFocusedElement;\nlet document;\nif (typeof window !== 'undefined' && typeof window.document !== 'undefined') {\n    document = window.document;\n}\nconst timeout = {};\nconst formatQR = (dataString, pairingPayload) => {\n    if (typeof dataString === 'string') {\n        const uri = getTzip10Link('tezos://', pairingPayload);\n        const qr = getQrData(uri, 'svg');\n        const qrString = qr.replace('<svg', `<svg class=\"beacon-alert__image\"`);\n        return `<div id=\"beacon--qr__container\">${qrString}<div id=\"beacon--qr__copy__container\"><button class=\"beacon-modal__button--outline\" id=\"beacon--qr__copy\">Copy</button></div></div>${dataString}`;\n    }\n    return dataString;\n};\nconst formatAlert = (id, body, title, buttons, pairingPayload) => {\n    const callToAction = title;\n    const buttonsHtml = buttons.map((button, index) => `<button id=\"beacon-alert-${id}-${index}\" class=\"beacon-modal__button${button.style === 'outline' ? '--outline' : ''}\">${button.text}</button>`);\n    let allStyles = alertTemplates.default.css;\n    if (pairingPayload) {\n        allStyles += alertTemplates.pair.css;\n    }\n    let alertContainer = alertTemplates.container;\n    alertContainer = replaceInTemplate(alertContainer, 'main', pairingPayload ? alertTemplates.pair.html : alertTemplates.default.html);\n    alertContainer = replaceInTemplate(alertContainer, 'callToAction', callToAction);\n    alertContainer = replaceInTemplate(alertContainer, 'buttons', buttonsHtml.join(' '));\n    alertContainer = replaceInTemplate(alertContainer, 'body', body);\n    alertContainer = replaceInTemplate(alertContainer, 'id', id);\n    alertContainer = replaceInTemplate(alertContainer, 'payload', pairingPayload !== null && pairingPayload !== void 0 ? pairingPayload : '');\n    if (alertContainer.indexOf('{{') >= 0) {\n        const start = alertContainer.indexOf('{{');\n        const end = alertContainer.indexOf('}}');\n        console.error('Not all placeholders replaced!', alertContainer.substr(start, end - start));\n        throw new Error('Not all placeholders replaced!');\n    }\n    return {\n        style: allStyles,\n        html: alertContainer\n    };\n};\n/**\n * Close an alert by ID\n *\n * @param id ID of alert\n */\nconst closeAlert = (id) => new Promise((resolve) => {\n    var _a;\n    const wrapper = document.getElementById(`beacon-alert-wrapper-${id}`);\n    if (!wrapper) {\n        return resolve();\n    }\n    const elm = (_a = wrapper.shadowRoot) === null || _a === void 0 ? void 0 : _a.getElementById(`beacon-alert-modal-${id}`);\n    if (elm) {\n        const animationDuration = 300;\n        const localTimeout = timeout[id];\n        if (localTimeout) {\n            clearTimeout(localTimeout);\n            timeout[id] = undefined;\n        }\n        elm.className = elm.className.replace('fadeIn', 'fadeOut');\n        window.setTimeout(() => {\n            const parent = wrapper.parentNode;\n            if (parent) {\n                parent.removeChild(wrapper);\n            }\n            if (lastFocusedElement) {\n                ;\n                lastFocusedElement.focus(); // set focus back to last focussed element\n            }\n            resolve();\n        }, animationDuration);\n    }\n    else {\n        resolve();\n    }\n});\n/**\n * Close all alerts\n */\nconst closeAlerts = () => __awaiter(void 0, void 0, void 0, function* () {\n    return new Promise((resolve) => __awaiter(void 0, void 0, void 0, function* () {\n        const openAlertElements = document.querySelectorAll('[id^=\"beacon-alert-wrapper-\"]');\n        if (openAlertElements.length > 0) {\n            const alertIds = [];\n            openAlertElements.forEach((element) => __awaiter(void 0, void 0, void 0, function* () {\n                alertIds.push(element.id.split('-')[3]);\n            }));\n            yield Promise.all(alertIds.map(closeAlert));\n            resolve();\n        }\n        else {\n            resolve();\n        }\n    }));\n});\n/**\n * Show an alert\n *\n * @param alertConfig The configuration of the alert\n */\n// eslint-disable-next-line complexity\nconst openAlert = (alertConfig) => __awaiter(void 0, void 0, void 0, function* () {\n    var _a, _b;\n    const body = alertConfig.body;\n    const title = alertConfig.title;\n    const timer = alertConfig.timer;\n    const pairingPayload = alertConfig.pairingPayload;\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const closeButtonCallback = alertConfig.closeButtonCallback;\n    yield closeAlerts();\n    const id = (yield generateGUID()).split('-').join('');\n    const shadowRootEl = document.createElement('div');\n    shadowRootEl.setAttribute('id', `beacon-alert-wrapper-${id}`);\n    const shadowRoot = shadowRootEl.attachShadow({ mode: 'open' });\n    const wrapper = document.createElement('div');\n    wrapper.setAttribute('tabindex', `0`); // Make modal focussable\n    shadowRoot.appendChild(wrapper);\n    const buttons = [\n        ...((_b = (_a = alertConfig.buttons) === null || _a === void 0 ? void 0 : _a.map((button) => {\n            var _a, _b;\n            return ({\n                text: button.text,\n                // eslint-disable-next-line @typescript-eslint/unbound-method\n                actionCallback: (_a = button.actionCallback) !== null && _a !== void 0 ? _a : (() => Promise.resolve()),\n                style: (_b = button.style) !== null && _b !== void 0 ? _b : 'outline'\n            });\n        })) !== null && _b !== void 0 ? _b : [])\n    ];\n    const formattedBody = body && pairingPayload ? formatQR(body, pairingPayload === null || pairingPayload === void 0 ? void 0 : pairingPayload.p2pSyncCode) : body !== null && body !== void 0 ? body : '';\n    const { style, html } = formatAlert(id, formattedBody, title, buttons, pairingPayload === null || pairingPayload === void 0 ? void 0 : pairingPayload.p2pSyncCode);\n    wrapper.innerHTML = html;\n    const styleEl = document.createElement('style');\n    styleEl.textContent = style;\n    shadowRoot.appendChild(styleEl);\n    if (timer) {\n        timeout[id] = window.setTimeout(() => __awaiter(void 0, void 0, void 0, function* () {\n            yield closeAlert(id);\n        }), timer);\n    }\n    document.body.prepend(shadowRootEl);\n    const closeButton = shadowRoot.getElementById(`beacon-alert-${id}-close`);\n    const closeButtonClick = () => __awaiter(void 0, void 0, void 0, function* () {\n        if (closeButtonCallback) {\n            closeButtonCallback();\n        }\n        yield closeAlert(id);\n    });\n    const colorMode = getColorMode();\n    const elm = shadowRoot.getElementById(`beacon-alert-modal-${id}`);\n    if (elm) {\n        elm.classList.add(`theme__${colorMode}`);\n        elm.addEventListener('click', closeButtonClick); // Backdrop click dismisses alert\n    }\n    const modal = shadowRoot.querySelectorAll('.beacon-modal__wrapper');\n    if (modal.length > 0) {\n        modal[0].addEventListener('click', (event) => {\n            event.stopPropagation();\n        });\n    }\n    lastFocusedElement = document.activeElement; // Store which element has been focussed before the alert is shown\n    wrapper.focus(); // Focus alert for accessibility\n    buttons.forEach((button, index) => {\n        const buttonElement = shadowRoot.getElementById(`beacon-alert-${id}-${index}`);\n        if (buttonElement) {\n            buttonElement.addEventListener('click', () => __awaiter(void 0, void 0, void 0, function* () {\n                yield closeAlert(id);\n                if (button.actionCallback) {\n                    yield button.actionCallback();\n                }\n            }));\n        }\n    });\n    if (closeButton) {\n        closeButton.addEventListener('click', () => __awaiter(void 0, void 0, void 0, function* () {\n            yield closeButtonClick();\n        }));\n    }\n    window.addEventListener('keydown', (event) => __awaiter(void 0, void 0, void 0, function* () {\n        if (event.key === 'Escape') {\n            yield closeButtonClick();\n        }\n    }));\n    if (pairingPayload) {\n        yield preparePairingAlert(shadowRoot, pairingPayload);\n    }\n    return id;\n});\nexport { closeAlert, closeAlerts, openAlert };\n//# sourceMappingURL=Alert.js.map"]},"metadata":{},"sourceType":"module"}