{"ast":null,"code":"import _classCallCheck from \"/Users/frankenstein/projects/minter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/frankenstein/projects/minter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"/Users/frankenstein/projects/minter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/frankenstein/projects/minter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\n\nvar _defaultEventCallback;\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { openAlert, closeAlerts } from './ui/alert/Alert';\nimport { closeToast, openToast } from './ui/toast/Toast';\nimport { Logger } from './utils/Logger';\nimport { Serializer } from './Serializer';\nimport { shortenString } from './utils/shorten-string';\nimport { BeaconErrorType } from './types/BeaconErrorType';\nimport { UnknownBeaconError, BeaconError } from '.';\nvar logger = new Logger('BeaconEvents');\nvar serializer = new Serializer();\nvar SUCCESS_TIMER = 5 * 1000;\nvar SVG_EXTERNAL = \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" data-prefix=\\\"fas\\\" data-icon=\\\"external-link-alt\\\" class=\\\"svg-inline--fa fa-external-link-alt fa-w-16\\\" role=\\\"img\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><path fill=\\\"currentColor\\\" d=\\\"M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z\\\"></path></svg>\";\n/**\n * The different events that can be emitted by the beacon-sdk\n */\n\nexport var BeaconEvent;\n\n(function (BeaconEvent) {\n  BeaconEvent[\"PERMISSION_REQUEST_SENT\"] = \"PERMISSION_REQUEST_SENT\";\n  BeaconEvent[\"PERMISSION_REQUEST_SUCCESS\"] = \"PERMISSION_REQUEST_SUCCESS\";\n  BeaconEvent[\"PERMISSION_REQUEST_ERROR\"] = \"PERMISSION_REQUEST_ERROR\";\n  BeaconEvent[\"OPERATION_REQUEST_SENT\"] = \"OPERATION_REQUEST_SENT\";\n  BeaconEvent[\"OPERATION_REQUEST_SUCCESS\"] = \"OPERATION_REQUEST_SUCCESS\";\n  BeaconEvent[\"OPERATION_REQUEST_ERROR\"] = \"OPERATION_REQUEST_ERROR\";\n  BeaconEvent[\"SIGN_REQUEST_SENT\"] = \"SIGN_REQUEST_SENT\";\n  BeaconEvent[\"SIGN_REQUEST_SUCCESS\"] = \"SIGN_REQUEST_SUCCESS\";\n  BeaconEvent[\"SIGN_REQUEST_ERROR\"] = \"SIGN_REQUEST_ERROR\";\n  BeaconEvent[\"BROADCAST_REQUEST_SENT\"] = \"BROADCAST_REQUEST_SENT\";\n  BeaconEvent[\"BROADCAST_REQUEST_SUCCESS\"] = \"BROADCAST_REQUEST_SUCCESS\";\n  BeaconEvent[\"BROADCAST_REQUEST_ERROR\"] = \"BROADCAST_REQUEST_ERROR\";\n  BeaconEvent[\"ACKNOWLEDGE_RECEIVED\"] = \"ACKNOWLEDGE_RECEIVED\";\n  BeaconEvent[\"LOCAL_RATE_LIMIT_REACHED\"] = \"LOCAL_RATE_LIMIT_REACHED\";\n  BeaconEvent[\"NO_PERMISSIONS\"] = \"NO_PERMISSIONS\";\n  BeaconEvent[\"ACTIVE_ACCOUNT_SET\"] = \"ACTIVE_ACCOUNT_SET\";\n  BeaconEvent[\"ACTIVE_TRANSPORT_SET\"] = \"ACTIVE_TRANSPORT_SET\";\n  BeaconEvent[\"PAIR_INIT\"] = \"PAIR_INIT\";\n  BeaconEvent[\"PAIR_SUCCESS\"] = \"PAIR_SUCCESS\";\n  BeaconEvent[\"CHANNEL_CLOSED\"] = \"CHANNEL_CLOSED\";\n  BeaconEvent[\"INTERNAL_ERROR\"] = \"INTERNAL_ERROR\";\n  BeaconEvent[\"UNKNOWN\"] = \"UNKNOWN\";\n})(BeaconEvent || (BeaconEvent = {}));\n/**\n * Show a \"Request sent\" toast\n */\n\n\nvar showSentToast = function showSentToast(data) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            openToast({\n              body: \"Request sent to&nbsp;{{wallet}}\",\n              walletInfo: data.walletInfo,\n              forceNew: true,\n              state: 'loading',\n              actions: [{\n                text: 'Did you make a mistake?',\n                actionText: 'Cancel Request',\n                actionCallback: function actionCallback() {\n                  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            _context.next = 2;\n                            return closeToast();\n\n                          case 2:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee);\n                  }));\n                }\n              }, {\n                text: 'Wallet not receiving request?',\n                actionText: 'Reset Connection',\n                actionCallback: function actionCallback() {\n                  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                    var resetCallback;\n                    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            _context2.next = 2;\n                            return closeToast();\n\n                          case 2:\n                            // eslint-disable-next-line @typescript-eslint/unbound-method\n                            resetCallback = data.extraInfo.resetCallback;\n\n                            if (!resetCallback) {\n                              _context2.next = 7;\n                              break;\n                            }\n\n                            logger.log('showSentToast', 'resetCallback invoked');\n                            _context2.next = 7;\n                            return resetCallback();\n\n                          case 7:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, _callee2);\n                  }));\n                }\n              }]\n            }).catch(function (toastError) {\n              return console.error(toastError);\n            });\n\n          case 1:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n};\n\nvar showAcknowledgedToast = function showAcknowledgedToast(data) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            openToast({\n              body: 'Awaiting confirmation in&nbsp;{{wallet}}',\n              state: 'acknowledge',\n              walletInfo: data.walletInfo\n            }).catch(function (toastError) {\n              return console.error(toastError);\n            });\n\n          case 1:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n};\n/**\n * Show a \"No Permission\" alert\n */\n\n\nvar showNoPermissionAlert = function showNoPermissionAlert() {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            _context5.next = 2;\n            return openAlert({\n              title: 'No Permission',\n              body: 'Please allow the wallet to handle this type of request.'\n            });\n\n          case 2:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n};\n/**\n * Show an error toast\n *\n * @param beaconError The beacon error\n */\n\n\nvar showErrorToast = function showErrorToast(response, buttons) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n    var error, actions;\n    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            error = response.errorResponse.errorType ? BeaconError.getError(response.errorResponse.errorType, response.errorResponse.errorData) : new UnknownBeaconError();\n            actions = [{\n              text: \"<strong>\".concat(error.title, \"</strong>\")\n            }, {\n              text: error.description\n            }];\n\n            if (response.errorResponse.errorType === BeaconErrorType.TRANSACTION_INVALID_ERROR && response.errorResponse.errorData) {\n              actions.push({\n                text: '',\n                actionText: 'Show Details',\n                actionCallback: function actionCallback() {\n                  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n                    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                      while (1) {\n                        switch (_context6.prev = _context6.next) {\n                          case 0:\n                            _context6.next = 2;\n                            return closeToast();\n\n                          case 2:\n                            _context6.next = 4;\n                            return openAlert({\n                              title: error.title,\n                              // eslint-disable-next-line @typescript-eslint/unbound-method\n                              body: error.fullDescription,\n                              buttons: buttons\n                            });\n\n                          case 4:\n                          case \"end\":\n                            return _context6.stop();\n                        }\n                      }\n                    }, _callee6);\n                  }));\n                }\n              });\n            }\n\n            _context7.next = 5;\n            return openToast({\n              body: \"{{wallet}}&nbsp;has returned an error\",\n              timer: response.errorResponse.errorType === BeaconErrorType.ABORTED_ERROR ? SUCCESS_TIMER : undefined,\n              state: 'finished',\n              walletInfo: response.walletInfo,\n              actions: actions\n            });\n\n          case 5:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n};\n/**\n * Show a rate limit reached toast\n */\n\n\nvar showRateLimitReached = function showRateLimitReached() {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n    return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            openAlert({\n              title: 'Error',\n              body: 'Rate limit reached. Please slow down',\n              buttons: [{\n                text: 'Done',\n                style: 'outline'\n              }],\n              timer: 3000\n            }).catch(function (toastError) {\n              return console.error(toastError);\n            });\n\n          case 1:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  }));\n};\n/**\n * Show a \"connection successful\" alert for 1.5 seconds\n */\n\n\nvar showExtensionConnectedAlert = function showExtensionConnectedAlert() {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n    return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n      while (1) {\n        switch (_context9.prev = _context9.next) {\n          case 0:\n            _context9.next = 2;\n            return closeAlerts();\n\n          case 2:\n          case \"end\":\n            return _context9.stop();\n        }\n      }\n    }, _callee9);\n  }));\n};\n/**\n * Show a \"channel closed\" alert for 1.5 seconds\n */\n\n\nvar showChannelClosedAlert = function showChannelClosedAlert() {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n    return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n      while (1) {\n        switch (_context10.prev = _context10.next) {\n          case 0:\n            _context10.next = 2;\n            return openAlert({\n              title: 'Channel closed',\n              body: \"Your peer has closed the connection.\",\n              buttons: [{\n                text: 'Done',\n                style: 'outline'\n              }],\n              timer: 1500\n            });\n\n          case 2:\n          case \"end\":\n            return _context10.stop();\n        }\n      }\n    }, _callee10);\n  }));\n};\n\nvar showInternalErrorAlert = function showInternalErrorAlert(data) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee11() {\n    var alertConfig;\n    return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n      while (1) {\n        switch (_context11.prev = _context11.next) {\n          case 0:\n            alertConfig = {\n              title: 'Internal Error',\n              body: \"\".concat(data),\n              buttons: [{\n                text: 'Done',\n                style: 'outline'\n              }]\n            };\n            _context11.next = 3;\n            return openAlert(alertConfig);\n\n          case 3:\n          case \"end\":\n            return _context11.stop();\n        }\n      }\n    }, _callee11);\n  }));\n};\n/**\n * Show a connect alert with QR code\n *\n * @param data The data that is emitted by the PAIR_INIT event\n */\n\n\nvar showPairAlert = function showPairAlert(data) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee12() {\n    var p2pBase58encoded, postmessageBase58encoded, alertConfig;\n    return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n      while (1) {\n        switch (_context12.prev = _context12.next) {\n          case 0:\n            _context12.next = 2;\n            return serializer.serialize(data.p2pPeerInfo);\n\n          case 2:\n            p2pBase58encoded = _context12.sent;\n            _context12.next = 5;\n            return serializer.serialize(data.postmessagePeerInfo);\n\n          case 5:\n            postmessageBase58encoded = _context12.sent;\n            alertConfig = {\n              title: 'Choose your preferred wallet',\n              body: \"<p></p>\",\n              pairingPayload: {\n                p2pSyncCode: p2pBase58encoded,\n                postmessageSyncCode: postmessageBase58encoded,\n                preferredNetwork: data.preferredNetwork\n              },\n              // eslint-disable-next-line @typescript-eslint/unbound-method\n              closeButtonCallback: data.abortedHandler\n            };\n            _context12.next = 9;\n            return openAlert(alertConfig);\n\n          case 9:\n          case \"end\":\n            return _context12.stop();\n        }\n      }\n    }, _callee12);\n  }));\n};\n/**\n * Show a \"Permission Granted\" alert\n *\n * @param data The data that is emitted by the PERMISSION_REQUEST_SUCCESS event\n */\n\n\nvar showPermissionSuccessAlert = function showPermissionSuccessAlert(data) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee13() {\n    var output;\n    return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n      while (1) {\n        switch (_context13.prev = _context13.next) {\n          case 0:\n            output = data.output;\n            _context13.next = 3;\n            return openToast({\n              body: \"{{wallet}}&nbsp;has granted permission\",\n              timer: SUCCESS_TIMER,\n              walletInfo: data.walletInfo,\n              state: 'finished',\n              actions: [{\n                text: 'Address',\n                actionText: \"<strong>\".concat(shortenString(output.address), \"</strong>\")\n              }, {\n                text: 'Network',\n                actionText: \"\".concat(output.network.type)\n              }, {\n                text: 'Permissions',\n                actionText: output.scopes.join(', ')\n              }]\n            });\n\n          case 3:\n          case \"end\":\n            return _context13.stop();\n        }\n      }\n    }, _callee13);\n  }));\n};\n/**\n * Show an \"Operation Broadcasted\" alert\n *\n * @param data The data that is emitted by the OPERATION_REQUEST_SUCCESS event\n */\n\n\nvar showOperationSuccessAlert = function showOperationSuccessAlert(data) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee15() {\n    var account, output, blockExplorer;\n    return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n      while (1) {\n        switch (_context15.prev = _context15.next) {\n          case 0:\n            account = data.account, output = data.output, blockExplorer = data.blockExplorer;\n            _context15.next = 3;\n            return openToast({\n              body: \"{{wallet}}&nbsp;successfully submitted operation\",\n              timer: SUCCESS_TIMER,\n              state: 'finished',\n              walletInfo: data.walletInfo,\n              actions: [{\n                text: \"<strong>\".concat(shortenString(output.transactionHash), \"</strong>\"),\n                actionText: \"Open Blockexplorer \".concat(SVG_EXTERNAL),\n                actionCallback: function actionCallback() {\n                  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee14() {\n                    var link;\n                    return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n                      while (1) {\n                        switch (_context14.prev = _context14.next) {\n                          case 0:\n                            _context14.next = 2;\n                            return blockExplorer.getTransactionLink(output.transactionHash, account.network);\n\n                          case 2:\n                            link = _context14.sent;\n                            window.open(link, '_blank');\n                            _context14.next = 6;\n                            return closeToast();\n\n                          case 6:\n                          case \"end\":\n                            return _context14.stop();\n                        }\n                      }\n                    }, _callee14);\n                  }));\n                }\n              }]\n            });\n\n          case 3:\n          case \"end\":\n            return _context15.stop();\n        }\n      }\n    }, _callee15);\n  }));\n};\n/**\n * Show a \"Transaction Signed\" alert\n *\n * @param data The data that is emitted by the SIGN_REQUEST_SUCCESS event\n */\n\n\nvar showSignSuccessAlert = function showSignSuccessAlert(data) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee17() {\n    var output;\n    return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n      while (1) {\n        switch (_context17.prev = _context17.next) {\n          case 0:\n            output = data.output;\n            _context17.next = 3;\n            return openToast({\n              body: \"{{wallet}}&nbsp;successfully signed payload\",\n              timer: SUCCESS_TIMER,\n              state: 'finished',\n              walletInfo: data.walletInfo,\n              actions: [{\n                text: \"Signature: <strong>\".concat(shortenString(output.signature), \"</strong>\"),\n                actionText: 'Copy to clipboard',\n                actionCallback: function actionCallback() {\n                  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee16() {\n                    return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n                      while (1) {\n                        switch (_context16.prev = _context16.next) {\n                          case 0:\n                            navigator.clipboard.writeText(output.signature).then(function () {\n                              logger.log('showSignSuccessAlert', 'Copying to clipboard was successful!');\n                            }, function (err) {\n                              logger.error('showSignSuccessAlert', 'Could not copy text to clipboard: ', err);\n                            });\n                            _context16.next = 3;\n                            return closeToast();\n\n                          case 3:\n                          case \"end\":\n                            return _context16.stop();\n                        }\n                      }\n                    }, _callee16);\n                  }));\n                }\n              }]\n            });\n\n          case 3:\n          case \"end\":\n            return _context17.stop();\n        }\n      }\n    }, _callee17);\n  }));\n};\n/**\n * Show a \"Broadcasted\" alert\n *\n * @param data The data that is emitted by the BROADCAST_REQUEST_SUCCESS event\n */\n\n\nvar showBroadcastSuccessAlert = function showBroadcastSuccessAlert(data) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee19() {\n    var network, output, blockExplorer;\n    return _regeneratorRuntime.wrap(function _callee19$(_context19) {\n      while (1) {\n        switch (_context19.prev = _context19.next) {\n          case 0:\n            network = data.network, output = data.output, blockExplorer = data.blockExplorer;\n            _context19.next = 3;\n            return openToast({\n              body: \"{{wallet}}&nbsp;successfully injected operation\",\n              timer: SUCCESS_TIMER,\n              state: 'finished',\n              walletInfo: data.walletInfo,\n              actions: [{\n                text: \"<strong>\".concat(shortenString(output.transactionHash), \"</strong>\"),\n                actionText: \"Open Blockexplorer \".concat(SVG_EXTERNAL),\n                actionCallback: function actionCallback() {\n                  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee18() {\n                    var link;\n                    return _regeneratorRuntime.wrap(function _callee18$(_context18) {\n                      while (1) {\n                        switch (_context18.prev = _context18.next) {\n                          case 0:\n                            _context18.next = 2;\n                            return blockExplorer.getTransactionLink(output.transactionHash, network);\n\n                          case 2:\n                            link = _context18.sent;\n                            window.open(link, '_blank');\n                            _context18.next = 6;\n                            return closeToast();\n\n                          case 6:\n                          case \"end\":\n                            return _context18.stop();\n                        }\n                      }\n                    }, _callee18);\n                  }));\n                }\n              }]\n            });\n\n          case 3:\n          case \"end\":\n            return _context19.stop();\n        }\n      }\n    }, _callee19);\n  }));\n};\n\nvar emptyHandler = function emptyHandler() {\n  return function () {\n    return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee20() {\n      return _regeneratorRuntime.wrap(function _callee20$(_context20) {\n        while (1) {\n          switch (_context20.prev = _context20.next) {\n            case 0:\n            case \"end\":\n              return _context20.stop();\n          }\n        }\n      }, _callee20);\n    }));\n  };\n};\n/**\n * The default event handlers\n */\n\n\nexport var defaultEventCallbacks = (_defaultEventCallback = {}, _defineProperty(_defaultEventCallback, BeaconEvent.PERMISSION_REQUEST_SENT, showSentToast), _defineProperty(_defaultEventCallback, BeaconEvent.PERMISSION_REQUEST_SUCCESS, showPermissionSuccessAlert), _defineProperty(_defaultEventCallback, BeaconEvent.PERMISSION_REQUEST_ERROR, showErrorToast), _defineProperty(_defaultEventCallback, BeaconEvent.OPERATION_REQUEST_SENT, showSentToast), _defineProperty(_defaultEventCallback, BeaconEvent.OPERATION_REQUEST_SUCCESS, showOperationSuccessAlert), _defineProperty(_defaultEventCallback, BeaconEvent.OPERATION_REQUEST_ERROR, showErrorToast), _defineProperty(_defaultEventCallback, BeaconEvent.SIGN_REQUEST_SENT, showSentToast), _defineProperty(_defaultEventCallback, BeaconEvent.SIGN_REQUEST_SUCCESS, showSignSuccessAlert), _defineProperty(_defaultEventCallback, BeaconEvent.SIGN_REQUEST_ERROR, showErrorToast), _defineProperty(_defaultEventCallback, BeaconEvent.BROADCAST_REQUEST_SENT, showSentToast), _defineProperty(_defaultEventCallback, BeaconEvent.BROADCAST_REQUEST_SUCCESS, showBroadcastSuccessAlert), _defineProperty(_defaultEventCallback, BeaconEvent.BROADCAST_REQUEST_ERROR, showErrorToast), _defineProperty(_defaultEventCallback, BeaconEvent.ACKNOWLEDGE_RECEIVED, showAcknowledgedToast), _defineProperty(_defaultEventCallback, BeaconEvent.LOCAL_RATE_LIMIT_REACHED, showRateLimitReached), _defineProperty(_defaultEventCallback, BeaconEvent.NO_PERMISSIONS, showNoPermissionAlert), _defineProperty(_defaultEventCallback, BeaconEvent.ACTIVE_ACCOUNT_SET, emptyHandler()), _defineProperty(_defaultEventCallback, BeaconEvent.ACTIVE_TRANSPORT_SET, emptyHandler()), _defineProperty(_defaultEventCallback, BeaconEvent.PAIR_INIT, showPairAlert), _defineProperty(_defaultEventCallback, BeaconEvent.PAIR_SUCCESS, showExtensionConnectedAlert), _defineProperty(_defaultEventCallback, BeaconEvent.CHANNEL_CLOSED, showChannelClosedAlert), _defineProperty(_defaultEventCallback, BeaconEvent.INTERNAL_ERROR, showInternalErrorAlert), _defineProperty(_defaultEventCallback, BeaconEvent.UNKNOWN, emptyHandler()), _defaultEventCallback);\n/**\n * @internalapi\n *\n * Handles beacon events\n */\n\nexport var BeaconEventHandler = /*#__PURE__*/function () {\n  function BeaconEventHandler() {\n    var _this$callbackMap;\n\n    var eventsToOverride = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var overrideAll = arguments.length > 1 ? arguments[1] : undefined;\n\n    _classCallCheck(this, BeaconEventHandler);\n\n    this.callbackMap = (_this$callbackMap = {}, _defineProperty(_this$callbackMap, BeaconEvent.PERMISSION_REQUEST_SENT, [defaultEventCallbacks.PERMISSION_REQUEST_SENT]), _defineProperty(_this$callbackMap, BeaconEvent.PERMISSION_REQUEST_SUCCESS, [defaultEventCallbacks.PERMISSION_REQUEST_SUCCESS]), _defineProperty(_this$callbackMap, BeaconEvent.PERMISSION_REQUEST_ERROR, [defaultEventCallbacks.PERMISSION_REQUEST_ERROR]), _defineProperty(_this$callbackMap, BeaconEvent.OPERATION_REQUEST_SENT, [defaultEventCallbacks.OPERATION_REQUEST_SENT]), _defineProperty(_this$callbackMap, BeaconEvent.OPERATION_REQUEST_SUCCESS, [defaultEventCallbacks.OPERATION_REQUEST_SUCCESS]), _defineProperty(_this$callbackMap, BeaconEvent.OPERATION_REQUEST_ERROR, [defaultEventCallbacks.OPERATION_REQUEST_ERROR]), _defineProperty(_this$callbackMap, BeaconEvent.SIGN_REQUEST_SENT, [defaultEventCallbacks.SIGN_REQUEST_SENT]), _defineProperty(_this$callbackMap, BeaconEvent.SIGN_REQUEST_SUCCESS, [defaultEventCallbacks.SIGN_REQUEST_SUCCESS]), _defineProperty(_this$callbackMap, BeaconEvent.SIGN_REQUEST_ERROR, [defaultEventCallbacks.SIGN_REQUEST_ERROR]), _defineProperty(_this$callbackMap, BeaconEvent.BROADCAST_REQUEST_SENT, [defaultEventCallbacks.BROADCAST_REQUEST_SENT]), _defineProperty(_this$callbackMap, BeaconEvent.BROADCAST_REQUEST_SUCCESS, [defaultEventCallbacks.BROADCAST_REQUEST_SUCCESS]), _defineProperty(_this$callbackMap, BeaconEvent.BROADCAST_REQUEST_ERROR, [defaultEventCallbacks.BROADCAST_REQUEST_ERROR]), _defineProperty(_this$callbackMap, BeaconEvent.ACKNOWLEDGE_RECEIVED, [defaultEventCallbacks.ACKNOWLEDGE_RECEIVED]), _defineProperty(_this$callbackMap, BeaconEvent.LOCAL_RATE_LIMIT_REACHED, [defaultEventCallbacks.LOCAL_RATE_LIMIT_REACHED]), _defineProperty(_this$callbackMap, BeaconEvent.NO_PERMISSIONS, [defaultEventCallbacks.NO_PERMISSIONS]), _defineProperty(_this$callbackMap, BeaconEvent.ACTIVE_ACCOUNT_SET, [defaultEventCallbacks.ACTIVE_ACCOUNT_SET]), _defineProperty(_this$callbackMap, BeaconEvent.ACTIVE_TRANSPORT_SET, [defaultEventCallbacks.ACTIVE_TRANSPORT_SET]), _defineProperty(_this$callbackMap, BeaconEvent.PAIR_INIT, [defaultEventCallbacks.PAIR_INIT]), _defineProperty(_this$callbackMap, BeaconEvent.PAIR_SUCCESS, [defaultEventCallbacks.PAIR_SUCCESS]), _defineProperty(_this$callbackMap, BeaconEvent.CHANNEL_CLOSED, [defaultEventCallbacks.CHANNEL_CLOSED]), _defineProperty(_this$callbackMap, BeaconEvent.INTERNAL_ERROR, [defaultEventCallbacks.INTERNAL_ERROR]), _defineProperty(_this$callbackMap, BeaconEvent.UNKNOWN, [defaultEventCallbacks.UNKNOWN]), _this$callbackMap);\n\n    if (overrideAll) {\n      this.setAllHandlers();\n    }\n\n    this.overrideDefaults(eventsToOverride);\n  }\n  /**\n   * A method to subscribe to a specific beacon event and register a callback\n   *\n   * @param event The event being emitted\n   * @param eventCallback The callback that will be invoked\n   */\n\n\n  _createClass(BeaconEventHandler, [{\n    key: \"on\",\n    value: function on(event, eventCallback) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee21() {\n        var listeners;\n        return _regeneratorRuntime.wrap(function _callee21$(_context21) {\n          while (1) {\n            switch (_context21.prev = _context21.next) {\n              case 0:\n                listeners = this.callbackMap[event] || [];\n                listeners.push(eventCallback);\n                this.callbackMap[event] = listeners;\n\n              case 3:\n              case \"end\":\n                return _context21.stop();\n            }\n          }\n        }, _callee21, this);\n      }));\n    }\n    /**\n     * Emit a beacon event\n     *\n     * @param event The event being emitted\n     * @param data The data to be emit\n     */\n\n  }, {\n    key: \"emit\",\n    value: function emit(event, data, eventCallback) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee23() {\n        var _this = this;\n\n        var listeners;\n        return _regeneratorRuntime.wrap(function _callee23$(_context23) {\n          while (1) {\n            switch (_context23.prev = _context23.next) {\n              case 0:\n                listeners = this.callbackMap[event];\n\n                if (listeners && listeners.length > 0) {\n                  listeners.forEach(function (listener) {\n                    return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee22() {\n                      return _regeneratorRuntime.wrap(function _callee22$(_context22) {\n                        while (1) {\n                          switch (_context22.prev = _context22.next) {\n                            case 0:\n                              _context22.prev = 0;\n                              _context22.next = 3;\n                              return listener(data, eventCallback);\n\n                            case 3:\n                              _context22.next = 8;\n                              break;\n\n                            case 5:\n                              _context22.prev = 5;\n                              _context22.t0 = _context22[\"catch\"](0);\n                              logger.error(\"error handling event \".concat(event), _context22.t0);\n\n                            case 8:\n                            case \"end\":\n                              return _context22.stop();\n                          }\n                        }\n                      }, _callee22, null, [[0, 5]]);\n                    }));\n                  });\n                }\n\n              case 2:\n              case \"end\":\n                return _context23.stop();\n            }\n          }\n        }, _callee23, this);\n      }));\n    }\n    /**\n     * Override beacon event default callbacks. This can be used to disable default alert/toast behaviour\n     *\n     * @param eventsToOverride An object with the events to override\n     */\n\n  }, {\n    key: \"overrideDefaults\",\n    value: function overrideDefaults(eventsToOverride) {\n      var _this2 = this;\n\n      Object.keys(eventsToOverride).forEach(function (untypedEvent) {\n        var eventType = untypedEvent;\n        var event = eventsToOverride[eventType];\n\n        if (event) {\n          _this2.callbackMap[eventType] = [event.handler];\n        }\n      });\n    }\n    /**\n     * Set all event callbacks to a specific handler.\n     */\n\n  }, {\n    key: \"setAllHandlers\",\n    value: function setAllHandlers(handler) {\n      var _this3 = this;\n\n      Object.keys(this.callbackMap).forEach(function (untypedEvent) {\n        var eventType = untypedEvent;\n        _this3.callbackMap[eventType] = [];\n\n        if (handler) {\n          _this3.callbackMap[eventType].push(handler);\n        } else {\n          _this3.callbackMap[eventType].push(function () {\n            for (var _len = arguments.length, data = new Array(_len), _key = 0; _key < _len; _key++) {\n              data[_key] = arguments[_key];\n            }\n\n            logger.log.apply(logger, [untypedEvent].concat(data));\n          });\n        }\n      });\n    }\n  }]);\n\n  return BeaconEventHandler;\n}();","map":{"version":3,"sources":["../../src/events.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { openAlert, closeAlerts } from './ui/alert/Alert';\nimport { closeToast, openToast } from './ui/toast/Toast';\nimport { Logger } from './utils/Logger';\nimport { Serializer } from './Serializer';\nimport { shortenString } from './utils/shorten-string';\nimport { BeaconErrorType } from './types/BeaconErrorType';\nimport { UnknownBeaconError, BeaconError } from '.';\nconst logger = new Logger('BeaconEvents');\nconst serializer = new Serializer();\nconst SUCCESS_TIMER = 5 * 1000;\nconst SVG_EXTERNAL = `<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"external-link-alt\" class=\"svg-inline--fa fa-external-link-alt fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z\"></path></svg>`;\n/**\n * The different events that can be emitted by the beacon-sdk\n */\nexport var BeaconEvent;\n(function (BeaconEvent) {\n    BeaconEvent[\"PERMISSION_REQUEST_SENT\"] = \"PERMISSION_REQUEST_SENT\";\n    BeaconEvent[\"PERMISSION_REQUEST_SUCCESS\"] = \"PERMISSION_REQUEST_SUCCESS\";\n    BeaconEvent[\"PERMISSION_REQUEST_ERROR\"] = \"PERMISSION_REQUEST_ERROR\";\n    BeaconEvent[\"OPERATION_REQUEST_SENT\"] = \"OPERATION_REQUEST_SENT\";\n    BeaconEvent[\"OPERATION_REQUEST_SUCCESS\"] = \"OPERATION_REQUEST_SUCCESS\";\n    BeaconEvent[\"OPERATION_REQUEST_ERROR\"] = \"OPERATION_REQUEST_ERROR\";\n    BeaconEvent[\"SIGN_REQUEST_SENT\"] = \"SIGN_REQUEST_SENT\";\n    BeaconEvent[\"SIGN_REQUEST_SUCCESS\"] = \"SIGN_REQUEST_SUCCESS\";\n    BeaconEvent[\"SIGN_REQUEST_ERROR\"] = \"SIGN_REQUEST_ERROR\";\n    BeaconEvent[\"BROADCAST_REQUEST_SENT\"] = \"BROADCAST_REQUEST_SENT\";\n    BeaconEvent[\"BROADCAST_REQUEST_SUCCESS\"] = \"BROADCAST_REQUEST_SUCCESS\";\n    BeaconEvent[\"BROADCAST_REQUEST_ERROR\"] = \"BROADCAST_REQUEST_ERROR\";\n    BeaconEvent[\"ACKNOWLEDGE_RECEIVED\"] = \"ACKNOWLEDGE_RECEIVED\";\n    BeaconEvent[\"LOCAL_RATE_LIMIT_REACHED\"] = \"LOCAL_RATE_LIMIT_REACHED\";\n    BeaconEvent[\"NO_PERMISSIONS\"] = \"NO_PERMISSIONS\";\n    BeaconEvent[\"ACTIVE_ACCOUNT_SET\"] = \"ACTIVE_ACCOUNT_SET\";\n    BeaconEvent[\"ACTIVE_TRANSPORT_SET\"] = \"ACTIVE_TRANSPORT_SET\";\n    BeaconEvent[\"PAIR_INIT\"] = \"PAIR_INIT\";\n    BeaconEvent[\"PAIR_SUCCESS\"] = \"PAIR_SUCCESS\";\n    BeaconEvent[\"CHANNEL_CLOSED\"] = \"CHANNEL_CLOSED\";\n    BeaconEvent[\"INTERNAL_ERROR\"] = \"INTERNAL_ERROR\";\n    BeaconEvent[\"UNKNOWN\"] = \"UNKNOWN\";\n})(BeaconEvent || (BeaconEvent = {}));\n/**\n * Show a \"Request sent\" toast\n */\nconst showSentToast = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    openToast({\n        body: `Request sent to&nbsp;{{wallet}}`,\n        walletInfo: data.walletInfo,\n        forceNew: true,\n        state: 'loading',\n        actions: [\n            {\n                text: 'Did you make a mistake?',\n                actionText: 'Cancel Request',\n                actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n                    yield closeToast();\n                })\n            },\n            {\n                text: 'Wallet not receiving request?',\n                actionText: 'Reset Connection',\n                actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n                    yield closeToast();\n                    // eslint-disable-next-line @typescript-eslint/unbound-method\n                    const resetCallback = data.extraInfo.resetCallback;\n                    if (resetCallback) {\n                        logger.log('showSentToast', 'resetCallback invoked');\n                        yield resetCallback();\n                    }\n                })\n            }\n        ]\n    }).catch((toastError) => console.error(toastError));\n});\nconst showAcknowledgedToast = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    openToast({\n        body: 'Awaiting confirmation in&nbsp;{{wallet}}',\n        state: 'acknowledge',\n        walletInfo: data.walletInfo\n    }).catch((toastError) => console.error(toastError));\n});\n/**\n * Show a \"No Permission\" alert\n */\nconst showNoPermissionAlert = () => __awaiter(void 0, void 0, void 0, function* () {\n    yield openAlert({\n        title: 'No Permission',\n        body: 'Please allow the wallet to handle this type of request.'\n    });\n});\n/**\n * Show an error toast\n *\n * @param beaconError The beacon error\n */\nconst showErrorToast = (response, buttons) => __awaiter(void 0, void 0, void 0, function* () {\n    const error = response.errorResponse.errorType\n        ? BeaconError.getError(response.errorResponse.errorType, response.errorResponse.errorData)\n        : new UnknownBeaconError();\n    const actions = [\n        {\n            text: `<strong>${error.title}</strong>`\n        },\n        {\n            text: error.description\n        }\n    ];\n    if (response.errorResponse.errorType === BeaconErrorType.TRANSACTION_INVALID_ERROR &&\n        response.errorResponse.errorData) {\n        actions.push({\n            text: '',\n            actionText: 'Show Details',\n            actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n                yield closeToast();\n                yield openAlert({\n                    title: error.title,\n                    // eslint-disable-next-line @typescript-eslint/unbound-method\n                    body: error.fullDescription,\n                    buttons\n                });\n            })\n        });\n    }\n    yield openToast({\n        body: `{{wallet}}&nbsp;has returned an error`,\n        timer: response.errorResponse.errorType === BeaconErrorType.ABORTED_ERROR\n            ? SUCCESS_TIMER\n            : undefined,\n        state: 'finished',\n        walletInfo: response.walletInfo,\n        actions\n    });\n});\n/**\n * Show a rate limit reached toast\n */\nconst showRateLimitReached = () => __awaiter(void 0, void 0, void 0, function* () {\n    openAlert({\n        title: 'Error',\n        body: 'Rate limit reached. Please slow down',\n        buttons: [{ text: 'Done', style: 'outline' }],\n        timer: 3000\n    }).catch((toastError) => console.error(toastError));\n});\n/**\n * Show a \"connection successful\" alert for 1.5 seconds\n */\nconst showExtensionConnectedAlert = () => __awaiter(void 0, void 0, void 0, function* () {\n    yield closeAlerts();\n});\n/**\n * Show a \"channel closed\" alert for 1.5 seconds\n */\nconst showChannelClosedAlert = () => __awaiter(void 0, void 0, void 0, function* () {\n    yield openAlert({\n        title: 'Channel closed',\n        body: `Your peer has closed the connection.`,\n        buttons: [{ text: 'Done', style: 'outline' }],\n        timer: 1500\n    });\n});\nconst showInternalErrorAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const alertConfig = {\n        title: 'Internal Error',\n        body: `${data}`,\n        buttons: [{ text: 'Done', style: 'outline' }]\n    };\n    yield openAlert(alertConfig);\n});\n/**\n * Show a connect alert with QR code\n *\n * @param data The data that is emitted by the PAIR_INIT event\n */\nconst showPairAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const p2pBase58encoded = yield serializer.serialize(data.p2pPeerInfo);\n    const postmessageBase58encoded = yield serializer.serialize(data.postmessagePeerInfo);\n    const alertConfig = {\n        title: 'Choose your preferred wallet',\n        body: `<p></p>`,\n        pairingPayload: {\n            p2pSyncCode: p2pBase58encoded,\n            postmessageSyncCode: postmessageBase58encoded,\n            preferredNetwork: data.preferredNetwork\n        },\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        closeButtonCallback: data.abortedHandler\n    };\n    yield openAlert(alertConfig);\n});\n/**\n * Show a \"Permission Granted\" alert\n *\n * @param data The data that is emitted by the PERMISSION_REQUEST_SUCCESS event\n */\nconst showPermissionSuccessAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const { output } = data;\n    yield openToast({\n        body: `{{wallet}}&nbsp;has granted permission`,\n        timer: SUCCESS_TIMER,\n        walletInfo: data.walletInfo,\n        state: 'finished',\n        actions: [\n            {\n                text: 'Address',\n                actionText: `<strong>${shortenString(output.address)}</strong>`\n            },\n            {\n                text: 'Network',\n                actionText: `${output.network.type}`\n            },\n            {\n                text: 'Permissions',\n                actionText: output.scopes.join(', ')\n            }\n        ]\n    });\n});\n/**\n * Show an \"Operation Broadcasted\" alert\n *\n * @param data The data that is emitted by the OPERATION_REQUEST_SUCCESS event\n */\nconst showOperationSuccessAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const { account, output, blockExplorer } = data;\n    yield openToast({\n        body: `{{wallet}}&nbsp;successfully submitted operation`,\n        timer: SUCCESS_TIMER,\n        state: 'finished',\n        walletInfo: data.walletInfo,\n        actions: [\n            {\n                text: `<strong>${shortenString(output.transactionHash)}</strong>`,\n                actionText: `Open Blockexplorer ${SVG_EXTERNAL}`,\n                actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n                    const link = yield blockExplorer.getTransactionLink(output.transactionHash, account.network);\n                    window.open(link, '_blank');\n                    yield closeToast();\n                })\n            }\n        ]\n    });\n});\n/**\n * Show a \"Transaction Signed\" alert\n *\n * @param data The data that is emitted by the SIGN_REQUEST_SUCCESS event\n */\nconst showSignSuccessAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const output = data.output;\n    yield openToast({\n        body: `{{wallet}}&nbsp;successfully signed payload`,\n        timer: SUCCESS_TIMER,\n        state: 'finished',\n        walletInfo: data.walletInfo,\n        actions: [\n            {\n                text: `Signature: <strong>${shortenString(output.signature)}</strong>`,\n                actionText: 'Copy to clipboard',\n                actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n                    navigator.clipboard.writeText(output.signature).then(() => {\n                        logger.log('showSignSuccessAlert', 'Copying to clipboard was successful!');\n                    }, (err) => {\n                        logger.error('showSignSuccessAlert', 'Could not copy text to clipboard: ', err);\n                    });\n                    yield closeToast();\n                })\n            }\n        ]\n    });\n});\n/**\n * Show a \"Broadcasted\" alert\n *\n * @param data The data that is emitted by the BROADCAST_REQUEST_SUCCESS event\n */\nconst showBroadcastSuccessAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const { network, output, blockExplorer } = data;\n    yield openToast({\n        body: `{{wallet}}&nbsp;successfully injected operation`,\n        timer: SUCCESS_TIMER,\n        state: 'finished',\n        walletInfo: data.walletInfo,\n        actions: [\n            {\n                text: `<strong>${shortenString(output.transactionHash)}</strong>`,\n                actionText: `Open Blockexplorer ${SVG_EXTERNAL}`,\n                actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n                    const link = yield blockExplorer.getTransactionLink(output.transactionHash, network);\n                    window.open(link, '_blank');\n                    yield closeToast();\n                })\n            }\n        ]\n    });\n});\nconst emptyHandler = () => () => __awaiter(void 0, void 0, void 0, function* () {\n    //\n});\n/**\n * The default event handlers\n */\nexport const defaultEventCallbacks = {\n    [BeaconEvent.PERMISSION_REQUEST_SENT]: showSentToast,\n    [BeaconEvent.PERMISSION_REQUEST_SUCCESS]: showPermissionSuccessAlert,\n    [BeaconEvent.PERMISSION_REQUEST_ERROR]: showErrorToast,\n    [BeaconEvent.OPERATION_REQUEST_SENT]: showSentToast,\n    [BeaconEvent.OPERATION_REQUEST_SUCCESS]: showOperationSuccessAlert,\n    [BeaconEvent.OPERATION_REQUEST_ERROR]: showErrorToast,\n    [BeaconEvent.SIGN_REQUEST_SENT]: showSentToast,\n    [BeaconEvent.SIGN_REQUEST_SUCCESS]: showSignSuccessAlert,\n    [BeaconEvent.SIGN_REQUEST_ERROR]: showErrorToast,\n    [BeaconEvent.BROADCAST_REQUEST_SENT]: showSentToast,\n    [BeaconEvent.BROADCAST_REQUEST_SUCCESS]: showBroadcastSuccessAlert,\n    [BeaconEvent.BROADCAST_REQUEST_ERROR]: showErrorToast,\n    [BeaconEvent.ACKNOWLEDGE_RECEIVED]: showAcknowledgedToast,\n    [BeaconEvent.LOCAL_RATE_LIMIT_REACHED]: showRateLimitReached,\n    [BeaconEvent.NO_PERMISSIONS]: showNoPermissionAlert,\n    [BeaconEvent.ACTIVE_ACCOUNT_SET]: emptyHandler(),\n    [BeaconEvent.ACTIVE_TRANSPORT_SET]: emptyHandler(),\n    [BeaconEvent.PAIR_INIT]: showPairAlert,\n    [BeaconEvent.PAIR_SUCCESS]: showExtensionConnectedAlert,\n    [BeaconEvent.CHANNEL_CLOSED]: showChannelClosedAlert,\n    [BeaconEvent.INTERNAL_ERROR]: showInternalErrorAlert,\n    [BeaconEvent.UNKNOWN]: emptyHandler()\n};\n/**\n * @internalapi\n *\n * Handles beacon events\n */\nexport class BeaconEventHandler {\n    constructor(eventsToOverride = {}, overrideAll) {\n        this.callbackMap = {\n            [BeaconEvent.PERMISSION_REQUEST_SENT]: [defaultEventCallbacks.PERMISSION_REQUEST_SENT],\n            [BeaconEvent.PERMISSION_REQUEST_SUCCESS]: [defaultEventCallbacks.PERMISSION_REQUEST_SUCCESS],\n            [BeaconEvent.PERMISSION_REQUEST_ERROR]: [defaultEventCallbacks.PERMISSION_REQUEST_ERROR],\n            [BeaconEvent.OPERATION_REQUEST_SENT]: [defaultEventCallbacks.OPERATION_REQUEST_SENT],\n            [BeaconEvent.OPERATION_REQUEST_SUCCESS]: [defaultEventCallbacks.OPERATION_REQUEST_SUCCESS],\n            [BeaconEvent.OPERATION_REQUEST_ERROR]: [defaultEventCallbacks.OPERATION_REQUEST_ERROR],\n            [BeaconEvent.SIGN_REQUEST_SENT]: [defaultEventCallbacks.SIGN_REQUEST_SENT],\n            [BeaconEvent.SIGN_REQUEST_SUCCESS]: [defaultEventCallbacks.SIGN_REQUEST_SUCCESS],\n            [BeaconEvent.SIGN_REQUEST_ERROR]: [defaultEventCallbacks.SIGN_REQUEST_ERROR],\n            [BeaconEvent.BROADCAST_REQUEST_SENT]: [defaultEventCallbacks.BROADCAST_REQUEST_SENT],\n            [BeaconEvent.BROADCAST_REQUEST_SUCCESS]: [defaultEventCallbacks.BROADCAST_REQUEST_SUCCESS],\n            [BeaconEvent.BROADCAST_REQUEST_ERROR]: [defaultEventCallbacks.BROADCAST_REQUEST_ERROR],\n            [BeaconEvent.ACKNOWLEDGE_RECEIVED]: [defaultEventCallbacks.ACKNOWLEDGE_RECEIVED],\n            [BeaconEvent.LOCAL_RATE_LIMIT_REACHED]: [defaultEventCallbacks.LOCAL_RATE_LIMIT_REACHED],\n            [BeaconEvent.NO_PERMISSIONS]: [defaultEventCallbacks.NO_PERMISSIONS],\n            [BeaconEvent.ACTIVE_ACCOUNT_SET]: [defaultEventCallbacks.ACTIVE_ACCOUNT_SET],\n            [BeaconEvent.ACTIVE_TRANSPORT_SET]: [defaultEventCallbacks.ACTIVE_TRANSPORT_SET],\n            [BeaconEvent.PAIR_INIT]: [defaultEventCallbacks.PAIR_INIT],\n            [BeaconEvent.PAIR_SUCCESS]: [defaultEventCallbacks.PAIR_SUCCESS],\n            [BeaconEvent.CHANNEL_CLOSED]: [defaultEventCallbacks.CHANNEL_CLOSED],\n            [BeaconEvent.INTERNAL_ERROR]: [defaultEventCallbacks.INTERNAL_ERROR],\n            [BeaconEvent.UNKNOWN]: [defaultEventCallbacks.UNKNOWN]\n        };\n        if (overrideAll) {\n            this.setAllHandlers();\n        }\n        this.overrideDefaults(eventsToOverride);\n    }\n    /**\n     * A method to subscribe to a specific beacon event and register a callback\n     *\n     * @param event The event being emitted\n     * @param eventCallback The callback that will be invoked\n     */\n    on(event, eventCallback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const listeners = this.callbackMap[event] || [];\n            listeners.push(eventCallback);\n            this.callbackMap[event] = listeners;\n        });\n    }\n    /**\n     * Emit a beacon event\n     *\n     * @param event The event being emitted\n     * @param data The data to be emit\n     */\n    emit(event, data, eventCallback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const listeners = this.callbackMap[event];\n            if (listeners && listeners.length > 0) {\n                listeners.forEach((listener) => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        yield listener(data, eventCallback);\n                    }\n                    catch (listenerError) {\n                        logger.error(`error handling event ${event}`, listenerError);\n                    }\n                }));\n            }\n        });\n    }\n    /**\n     * Override beacon event default callbacks. This can be used to disable default alert/toast behaviour\n     *\n     * @param eventsToOverride An object with the events to override\n     */\n    overrideDefaults(eventsToOverride) {\n        Object.keys(eventsToOverride).forEach((untypedEvent) => {\n            const eventType = untypedEvent;\n            const event = eventsToOverride[eventType];\n            if (event) {\n                this.callbackMap[eventType] = [event.handler];\n            }\n        });\n    }\n    /**\n     * Set all event callbacks to a specific handler.\n     */\n    setAllHandlers(handler) {\n        Object.keys(this.callbackMap).forEach((untypedEvent) => {\n            const eventType = untypedEvent;\n            this.callbackMap[eventType] = [];\n            if (handler) {\n                this.callbackMap[eventType].push(handler);\n            }\n            else {\n                this.callbackMap[eventType].push((...data) => {\n                    logger.log(untypedEvent, ...data);\n                });\n            }\n        });\n    }\n}\n//# sourceMappingURL=events.js.map"]},"metadata":{},"sourceType":"module"}